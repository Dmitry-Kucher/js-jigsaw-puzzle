{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/classes/Composition.js","src/classes/Gamefield.js","src/classes/Gameloop.js","src/classes/Image.js","src/classes/Piece.js","src/classes/RecalculatedObjectsGroup.js","src/test.js"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * Created by dima on 02/07/2017.\n */\nimport Piece from './Piece';\n\nexport default class Composition {\n  constructor() {\n    const pieces = [];\n\n    this.addPiece = (piece) => {\n      if (!(piece instanceof Piece)) {\n        throw Error('Composition can`t store anything except except instance of Piece');\n      }\n      pieces.push(piece);\n    };\n\n    this.getPieces = () => pieces;\n  }\n}\n","/**\n * Created by dima on 02/07/2017.\n */\nexport default class Gamefield {\n  constructor({ width = 1024, height = 1024, canvasId = 'c' } = {}) {\n    let canvas;\n\n    this.getWidth = () => width;\n    this.getHeight = () => height;\n    this.getCanvasId = () => canvasId;\n    this.setCanvas = (canvasField) => {\n      canvas = canvasField;\n    };\n    this.getCanvas = () => canvas;\n\n    this.createField();\n  }\n\n  createField() {\n    const canvasId = this.getCanvasId();\n    if (!document.querySelector(`#${canvasId}`)) {\n      console.log('canvas doesn`t exists');\n      // create canvas element if it doesn't exists;\n      const canvasElement = document.createElement('canvas');\n      canvasElement.id = canvasId;\n      canvasElement.width = this.getWidth();\n      canvasElement.height = this.getHeight();\n      document.body.appendChild(canvasElement);\n    }\n    const canvas = new fabric.Canvas(canvasId, {\n      renderOnAddRemove: false,\n      selection: false,\n      backgroundColor: '#0f0',\n      width: this.getWidth(),\n      height: this.getHeight(),\n    });\n    this.setCanvas(canvas);\n  }\n}\n","/**\n * Created by dima on 02/07/2017.\n */\nimport Image from './Image';\nimport Gamefield from './Gamefield';\nimport RecalculatedObjectsGroup from './RecalculatedObjectsGroup';\n\nexport default class Gameloop {\n  constructor(options) {\n    if (!options.imageSelector) {\n      throw Error('image selector is not defined');\n    }\n    let canvas;\n    this.getOptions = () => options;\n\n    this.getCanvas = () => canvas;\n    this.setCanvas = (internalCanvas) => {\n      canvas = internalCanvas;\n    };\n  }\n\n  start() {\n    window.addEventListener('load', () => {\n      const options = this.getOptions();\n      const gameField = new Gamefield({\n        width: 1420,\n        height: 2048,\n        canvasId: options.canvasId,\n      });\n      const canvas = gameField.getCanvas();\n      this.setCanvas(canvas);\n      this.drawPieces(options.scale);\n      canvas.on('object:selected', () => {\n        if (window.debugApp) {\n          const activeObject = canvas.getActiveObject();\n          console.log(activeObject);\n        }\n      });\n      canvas.on('object:modified', () => {\n        const activeObject = canvas.getActiveObject();\n        if (activeObject instanceof fabric.Path) {\n          return;\n        }\n        activeObject.trigger('recalculate');\n        const activeObjectNeighbours = this.getNeighbours(activeObject);\n        let isMerged = false;\n        canvas.forEachObject((potential) => {\n          if (isMerged) {\n            return;\n          }\n          if (potential === activeObject || !activeObject) {\n            return;\n          }\n\n          if (Gameloop.isNeighbour(activeObjectNeighbours, potential)) {\n            if (this.isClosest(activeObject, potential)) {\n              isMerged = true;\n              this.drawGroup(activeObject, potential);\n              canvas.remove(activeObject);\n              canvas.remove(potential);\n            }\n          }\n        });\n      });\n    });\n  }\n\n  drawSvg(img) {\n    const canvas = this.getCanvas();\n    const path = new fabric.Path(\n      'M85.446,52.284c-3.901,0-5.223-2.17-5.773-3.058c-1.146-1.85-3.291-3.455-5.469-4.268c-1.049-0.251-2.159,0.377-2.165,2.342  v24.737h-0.001v0.001H46.287c-1.978,0.002-2.604,1.122-2.347,2.177c0.815,2.173,2.418,4.312,4.264,5.457  c0.889,0.551,3.058,1.872,3.058,5.772c0,5.277-5.934,9.555-13.253,9.555c-7.32,0-13.254-4.277-13.254-9.555  c0-3.901,2.17-5.222,3.059-5.772c1.848-1.147,3.453-3.291,4.268-5.469c0.249-1.049-0.379-2.159-2.342-2.165H5V47.314  c0-1.977,1.114-2.606,2.166-2.355c2.178,0.812,4.322,2.418,5.47,4.268c0.551,0.888,1.871,3.058,5.772,3.058  c5.278,0,9.556-5.934,9.556-13.254c0-7.319-4.277-13.253-9.556-13.253c-3.901,0-5.222,2.17-5.772,3.059  c-1.146,1.845-3.284,3.447-5.458,4.263C6.122,33.356,5,32.727,5,30.745V5h67.038v0.001L72.039,5v25.759  c0.006,1.97,1.124,2.597,2.177,2.34c2.173-0.815,4.312-2.418,5.457-4.263c0.551-0.889,1.872-3.059,5.773-3.059  c5.276,0,9.554,5.934,9.554,13.253C95,46.351,90.723,52.284,85.446,52.284z',\n      {\n        fill: new fabric.Pattern({\n          source: img,\n        }),\n      },\n    );\n    path.set({ top: 150, left: 150 });\n    canvas.add(path);\n    canvas.renderAll();\n  }\n\n  drawPieces(scale = 1) {\n    const options = this.getOptions();\n    const canvas = this.getCanvas();\n    const image = new Image(options.imageSelector);\n\n    image.splitImageToPieces({ colLength: options.cols, rowLength: options.rows });\n    const pieces = image.getImagePieces();\n\n    pieces.forEach((piece, piecePosition) => {\n      const last = piecePosition === (pieces.length - 1);\n      const drawCallback = Gameloop.drawCallback.bind(null, { canvas, last, piecePosition, scale });\n      // const drawSvg = this.drawSvg.bind(this);\n      fabric.Image.fromURL(piece.getContent(), drawCallback);\n      // fabric.util.loadImage(piece.getContent(), drawSvg);\n    });\n  }\n\n  static drawCallback(additionalParams, img) {\n    const { canvas, last, piecePosition, scale } = additionalParams;\n    const top = fabric.util.getRandomInt(0, 300);\n    const left = fabric.util.getRandomInt(0, 300);\n\n    img.set('hasControls', false);\n    img.set('hasBorders', false);\n    img.set('top', top);\n    img.set('left', left);\n    img.set('piecePosition', piecePosition);\n    img.scale(scale);\n\n    canvas.add(img);\n    if (last) {\n      canvas.renderAll();\n    }\n  }\n\n  getNeighbours(examObject) {\n    const neighbours = [];\n    if (examObject) {\n      let piecePositions = [];\n      if (typeof examObject.piecePosition !== 'undefined') {\n        piecePositions.push(examObject.piecePosition);\n      } else if (examObject.piecePositions instanceof Array) {\n        piecePositions = examObject.piecePositions;\n      } else {\n        throw Error('examObject doesn`t contain any info about piece position');\n      }\n      const options = this.getOptions();\n      piecePositions.forEach((piecePosition) => {\n        const actualRow = Math.floor(piecePosition / options.cols);\n        const actualCol = piecePosition % options.cols;\n        if (actualRow !== 0) {\n          neighbours.push((piecePosition - options.cols));\n        }\n        if (actualRow < (options.rows - 1)) {\n          neighbours.push((piecePosition + options.cols));\n        }\n\n        if (actualCol !== 0) {\n          neighbours.push((piecePosition - 1));\n        }\n        if (actualCol < (options.cols - 1)) {\n          neighbours.push((piecePosition + 1));\n        }\n      });\n    }\n    return neighbours;\n  }\n\n  isClosest(current, potential) {\n    const activeObjectItems = current instanceof fabric.Group ? current.getObjects() : [current];\n    const potentialItems = potential instanceof fabric.Group ? potential.getObjects() : [potential];\n\n    for (const activeItem of activeObjectItems) {\n      for (const potentialItem of potentialItems) {\n        if (this.isPiecesClose(activeItem, potentialItem)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  isPiecesClose(firstPiece, secondPiece) {\n    const options = this.getOptions();\n    const closestSensitivity = options.neighboursSensitivity;\n    let xDifference = Math.abs(firstPiece.aCoords.tr.x - secondPiece.aCoords.tl.x);\n    let yDifference = Math.abs(firstPiece.aCoords.tr.y - secondPiece.aCoords.tl.y);\n    if (xDifference < closestSensitivity && yDifference < closestSensitivity) {\n      return true;\n    }\n\n    xDifference = Math.abs(firstPiece.aCoords.tl.x - secondPiece.aCoords.tr.x);\n    yDifference = Math.abs(firstPiece.aCoords.tl.y - secondPiece.aCoords.tr.y);\n    if (xDifference < closestSensitivity && yDifference < closestSensitivity) {\n      return true;\n    }\n\n    xDifference = Math.abs(firstPiece.aCoords.bl.x - secondPiece.aCoords.tl.x);\n    yDifference = Math.abs(firstPiece.aCoords.bl.y - secondPiece.aCoords.tl.y);\n    if (xDifference < closestSensitivity && yDifference < closestSensitivity) {\n      return true;\n    }\n\n    xDifference = Math.abs(firstPiece.aCoords.tl.x - secondPiece.aCoords.bl.x);\n    yDifference = Math.abs(firstPiece.aCoords.tl.y - secondPiece.aCoords.bl.y);\n    return xDifference < closestSensitivity && yDifference < closestSensitivity;\n  }\n\n  static isNeighbour(activeObjectNeighbours, potential) {\n    if (potential instanceof fabric.Group) {\n      for (const potentialItem of potential.getObjects()) {\n        if (activeObjectNeighbours.indexOf(potentialItem.piecePosition) !== -1) {\n          return true;\n        }\n      }\n    } else if (typeof potential.piecePosition !== 'undefined') {\n      return activeObjectNeighbours.indexOf(potential.piecePosition) !== -1;\n    }\n    return false;\n  }\n\n  drawGroup(activeObject, potential) {\n    const canvas = this.getCanvas();\n    const groupItems = [];\n    const piecePositions = [];\n    const options = this.getOptions();\n    const baseElements = potential instanceof fabric.Group ? potential.getObjects() : [potential];\n    const activeObjects = activeObject instanceof fabric.Group ? activeObject.getObjects() : [activeObject];\n\n    // baseElement is the potential element itself or first element from group;\n    const baseElement = baseElements[0];\n    const { col, row } = Gameloop.extractCoordinates(baseElement, options.cols);\n    const zeroDisplacementX = col * baseElement.getWidth();\n    const zeroDisplacementY = row * baseElement.getHeight();\n    const xDisplacement = baseElement.left - zeroDisplacementX;\n    const yDisplacement = baseElement.top - zeroDisplacementY;\n\n    const itemDecompose = (activePiece) => {\n      this.recalculatePiecePositions({\n        obj: activePiece,\n        xDisplacement,\n        yDisplacement,\n      });\n      piecePositions.push(activePiece.piecePosition);\n      groupItems.push(activePiece);\n    };\n\n    activeObjects.forEach(itemDecompose);\n    baseElements.forEach(itemDecompose);\n\n    const itemsRecalculableGroup = new RecalculatedObjectsGroup(groupItems, {\n      hasControls: false,\n      hasBorders: false,\n    });\n    itemsRecalculableGroup.set('piecePositions', piecePositions);\n    canvas.add(itemsRecalculableGroup);\n    canvas.renderAll();\n\n    // recalculated group objects coordinates\n    // it prevents to disappearing group object after merge\n    itemsRecalculableGroup.trigger('selected');\n    itemsRecalculableGroup.trigger('recalculate');\n  }\n\n  recalculatePiecePositions({ obj, xDisplacement, yDisplacement }) {\n    const options = this.getOptions();\n    const { col, row } = Gameloop.extractCoordinates(obj, options.cols);\n    const zeroDisplacementTop = row * obj.getHeight();\n    const zeroDisplacementLeft = col * obj.getWidth();\n    const recalculatedTop = zeroDisplacementTop + yDisplacement;\n    const recalculatedLeft = zeroDisplacementLeft + xDisplacement;\n    obj.setTop(recalculatedTop);\n    obj.setLeft(recalculatedLeft);\n    obj.setCoords();\n  }\n\n  static extractCoordinates(obj, cols) {\n    const col = obj.piecePosition % cols;\n    const row = Math.floor(obj.piecePosition / cols);\n    return { col, row };\n  }\n}\n","/**\n * Created by dima on 09/06/2017.\n */\nimport Piece from './Piece';\nimport Composition from './Composition';\n\nexport default class Image {\n  constructor(selector) {\n    const imageSelector = `img${selector}`;\n    this.imageElement = document.querySelector(imageSelector);\n    if (!this.imageElement) {\n      throw Error(`There is no img element with provided selector ${imageSelector}`);\n    }\n\n    this.imageInstance = this.getFabricImageInstance();\n    this.imagePieces = new Composition();\n  }\n\n  getFabricImageInstance() {\n    return this.imageInstance || new fabric.Image(this.imageElement);\n  }\n\n  splitImageToPieces({ colLength = 6, rowLength = 6 } = {}) {\n    const colSize = this.imageInstance.getWidth() / colLength;\n    const rowSize = this.imageInstance.getHeight() / rowLength;\n    for (let row = 0; row < rowLength; row += 1) {\n      for (let col = 0; col < colLength; col += 1) {\n        const dataUrl = this.imageInstance.toDataURL({\n          left: colSize * col,\n          top: rowSize * row,\n          width: colSize,\n          height: rowSize,\n        });\n        const pieceOptions = {\n          content: dataUrl,\n          position: row * col,\n        };\n        const piece = new Piece(pieceOptions);\n        this.imagePieces.addPiece(piece);\n      }\n    }\n  }\n\n  getImagePieces() {\n    return this.imagePieces.getPieces();\n  }\n\n  getImageElement() {\n    return this.imageElement;\n  }\n}\n","/**\n * Created by dima on 02/07/2017.\n */\nexport default class Piece {\n  constructor({ content, position } = {}) {\n    if (typeof content === 'undefined' || typeof position === 'undefined') {\n      throw Error('piece required content and position');\n    }\n    this.getContent = () => content;\n    this.getPosition = () => position;\n    return this.getContent();\n  }\n\n  getRow(cols) {\n    return Math.floor(this.getPosition() / cols);\n  }\n\n  getCol(cols) {\n    return this.getPosition() % cols;\n  }\n}\n","/**\n * Created by dima on 07/07/2017.\n */\nexport default class RecalculatedObjectsGroup {\n  constructor(groupItems, options = {}) {\n    if (!Array.isArray(groupItems)) {\n      throw Error('Group Items must be an array');\n    }\n    const group = new fabric.Group(groupItems, options);\n    group.on('selected', this.onSelected);\n    group.on('recalculate', this.onModified);\n\n    group.recalculateACoords = this.recalculateACoords;\n    group.onModified = this.onModified;\n    return group;\n  }\n\n  onSelected() {\n    this.selectedTop = this.top;\n    this.selectedLeft = this.left;\n  }\n\n  onModified() {\n    const groupObjects = this.getObjects();\n    groupObjects.forEach((groupItem) => {\n      this.recalculateACoords(groupItem);\n    });\n  }\n\n  recalculateACoords(item) {\n    const coords = {};\n    const itemCoords = item.aCoords;\n    const x = this.left - this.selectedLeft;\n    const y = this.top - this.selectedTop;\n    const offset = { x, y };\n\n    coords.tr = new fabric.Point(itemCoords.tr.x + offset.x, itemCoords.tr.y + offset.y);\n    coords.tl = new fabric.Point(itemCoords.tl.x + offset.x, itemCoords.tl.y + offset.y);\n    coords.br = new fabric.Point(itemCoords.br.x + offset.x, itemCoords.br.y + offset.y);\n    coords.bl = new fabric.Point(itemCoords.bl.x + offset.x, itemCoords.bl.y + offset.y);\n    item.aCoords = coords;\n    item.top = coords.tl.y;\n    item.left = coords.tl.x;\n  }\n}\n","/**\n * Created by dima on 18/05/2017.\n */\nimport Gameloop from './classes/Gameloop';\n\nconst options = {\n  canvasId: 'c',\n  rows: 6,\n  cols: 6,\n  scale: 0.8,\n  imageSelector: '[jjp-image]',\n  neighboursSensitivity: 20,\n};\nconst gameLoop = new Gameloop(options);\n\ngameLoop.start();\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvY2xhc3Nlcy9Db21wb3NpdGlvbi5qcyIsInNyYy9jbGFzc2VzL0dhbWVmaWVsZC5qcyIsInNyYy9jbGFzc2VzL0dhbWVsb29wLmpzIiwic3JjL2NsYXNzZXMvSW1hZ2UuanMiLCJzcmMvY2xhc3Nlcy9QaWVjZS5qcyIsInNyYy9jbGFzc2VzL1JlY2FsY3VsYXRlZE9iamVjdHNHcm91cC5qcyIsInNyYy90ZXN0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7O0FDR0E7Ozs7OzswSkFIQTs7Ozs7SUFLcUIsVyxHQUNuQix1QkFBYztBQUFBOztBQUNaLE1BQU0sU0FBUyxFQUFmOztBQUVBLE9BQUssUUFBTCxHQUFnQixVQUFDLEtBQUQsRUFBVztBQUN6QixRQUFJLEVBQUUsZ0NBQUYsQ0FBSixFQUErQjtBQUM3QixZQUFNLE1BQU0sa0VBQU4sQ0FBTjtBQUNEO0FBQ0QsV0FBTyxJQUFQLENBQVksS0FBWjtBQUNELEdBTEQ7O0FBT0EsT0FBSyxTQUFMLEdBQWlCO0FBQUEsV0FBTSxNQUFOO0FBQUEsR0FBakI7QUFDRCxDOztrQkFaa0IsVzs7Ozs7Ozs7Ozs7OztBQ0xyQjs7O0lBR3FCLFM7QUFDbkIsdUJBQWtFO0FBQUEsbUZBQUosRUFBSTtBQUFBLDBCQUFwRCxLQUFvRDtBQUFBLFFBQXBELEtBQW9ELDhCQUE1QyxJQUE0QztBQUFBLDJCQUF0QyxNQUFzQztBQUFBLFFBQXRDLE1BQXNDLCtCQUE3QixJQUE2QjtBQUFBLDZCQUF2QixRQUF1QjtBQUFBLFFBQXZCLFFBQXVCLGlDQUFaLEdBQVk7O0FBQUE7O0FBQ2hFLFFBQUksZUFBSjs7QUFFQSxTQUFLLFFBQUwsR0FBZ0I7QUFBQSxhQUFNLEtBQU47QUFBQSxLQUFoQjtBQUNBLFNBQUssU0FBTCxHQUFpQjtBQUFBLGFBQU0sTUFBTjtBQUFBLEtBQWpCO0FBQ0EsU0FBSyxXQUFMLEdBQW1CO0FBQUEsYUFBTSxR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QUFkLEdBQWtCLE9BQU8sQ0FBdEUsQ0FBWjtBQUNBLGFBQU8sRUFBUCxHQUFZLElBQUksT0FBTyxLQUFYLENBQWlCLFdBQVcsRUFBWCxDQUFjLENBQWQsR0FBa0IsT0FBTyxDQUExQyxFQUE2QyxXQUFXLEVBQVgsQ0FBYyxDQUFkLEdBQWtCLE9BQU8sQ0FBdEUsQ0FBWjtBQUNBLFdBQUssT0FBTCxHQUFlLE1BQWY7QUFDQSxXQUFLLEdBQUwsR0FBVyxPQUFPLEVBQVAsQ0FBVSxDQUFyQjtBQUNBLFdBQUssSUFBTCxHQUFZLE9BQU8sRUFBUCxDQUFVLENBQXRCO0FBQ0Q7Ozs7OztrQkF4Q2tCLHdCOzs7OztBQ0FyQjs7Ozs7O0FBRUEsSUFBTSxVQUFVO0FBQ2QsWUFBVSxHQURJO0FBRWQsUUFBTSxDQUZRO0FBR2QsUUFBTSxDQUhRO0FBSWQsU0FBTyxHQUpPO0FBS2QsaUJBQWUsYUFMRDtBQU1kLHlCQUF1QjtBQU5ULENBQWhCLEMsQ0FMQTs7OztBQWFBLElBQU0sV0FBVyx1QkFBYSxPQUFiLENBQWpCOztBQUVBLFNBQVMsS0FBVCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKipcbiAqIENyZWF0ZWQgYnkgZGltYSBvbiAwMi8wNy8yMDE3LlxuICovXG5pbXBvcnQgUGllY2UgZnJvbSAnLi9QaWVjZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbXBvc2l0aW9uIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgY29uc3QgcGllY2VzID0gW107XG5cbiAgICB0aGlzLmFkZFBpZWNlID0gKHBpZWNlKSA9PiB7XG4gICAgICBpZiAoIShwaWVjZSBpbnN0YW5jZW9mIFBpZWNlKSkge1xuICAgICAgICB0aHJvdyBFcnJvcignQ29tcG9zaXRpb24gY2FuYHQgc3RvcmUgYW55dGhpbmcgZXhjZXB0IGV4Y2VwdCBpbnN0YW5jZSBvZiBQaWVjZScpO1xuICAgICAgfVxuICAgICAgcGllY2VzLnB1c2gocGllY2UpO1xuICAgIH07XG5cbiAgICB0aGlzLmdldFBpZWNlcyA9ICgpID0+IHBpZWNlcztcbiAgfVxufVxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGRpbWEgb24gMDIvMDcvMjAxNy5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZWZpZWxkIHtcbiAgY29uc3RydWN0b3IoeyB3aWR0aCA9IDEwMjQsIGhlaWdodCA9IDEwMjQsIGNhbnZhc0lkID0gJ2MnIH0gPSB7fSkge1xuICAgIGxldCBjYW52YXM7XG5cbiAgICB0aGlzLmdldFdpZHRoID0gKCkgPT4gd2lkdGg7XG4gICAgdGhpcy5nZXRIZWlnaHQgPSAoKSA9PiBoZWlnaHQ7XG4gICAgdGhpcy5nZXRDYW52YXNJZCA9ICgpID0+IGNhbnZhc0lkO1xuICAgIHRoaXMuc2V0Q2FudmFzID0gKGNhbnZhc0ZpZWxkKSA9PiB7XG4gICAgICBjYW52YXMgPSBjYW52YXNGaWVsZDtcbiAgICB9O1xuICAgIHRoaXMuZ2V0Q2FudmFzID0gKCkgPT4gY2FudmFzO1xuXG4gICAgdGhpcy5jcmVhdGVGaWVsZCgpO1xuICB9XG5cbiAgY3JlYXRlRmllbGQoKSB7XG4gICAgY29uc3QgY2FudmFzSWQgPSB0aGlzLmdldENhbnZhc0lkKCk7XG4gICAgaWYgKCFkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtjYW52YXNJZH1gKSkge1xuICAgICAgY29uc29sZS5sb2coJ2NhbnZhcyBkb2VzbmB0IGV4aXN0cycpO1xuICAgICAgLy8gY3JlYXRlIGNhbnZhcyBlbGVtZW50IGlmIGl0IGRvZXNuJ3QgZXhpc3RzO1xuICAgICAgY29uc3QgY2FudmFzRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgICAgY2FudmFzRWxlbWVudC5pZCA9IGNhbnZhc0lkO1xuICAgICAgY2FudmFzRWxlbWVudC53aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTtcbiAgICAgIGNhbnZhc0VsZW1lbnQuaGVpZ2h0ID0gdGhpcy5nZXRIZWlnaHQoKTtcbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY2FudmFzRWxlbWVudCk7XG4gICAgfVxuICAgIGNvbnN0IGNhbnZhcyA9IG5ldyBmYWJyaWMuQ2FudmFzKGNhbnZhc0lkLCB7XG4gICAgICByZW5kZXJPbkFkZFJlbW92ZTogZmFsc2UsXG4gICAgICBzZWxlY3Rpb246IGZhbHNlLFxuICAgICAgYmFja2dyb3VuZENvbG9yOiAnIzBmMCcsXG4gICAgICB3aWR0aDogdGhpcy5nZXRXaWR0aCgpLFxuICAgICAgaGVpZ2h0OiB0aGlzLmdldEhlaWdodCgpLFxuICAgIH0pO1xuICAgIHRoaXMuc2V0Q2FudmFzKGNhbnZhcyk7XG4gIH1cbn1cbiIsIi8qKlxuICogQ3JlYXRlZCBieSBkaW1hIG9uIDAyLzA3LzIwMTcuXG4gKi9cbmltcG9ydCBJbWFnZSBmcm9tICcuL0ltYWdlJztcbmltcG9ydCBHYW1lZmllbGQgZnJvbSAnLi9HYW1lZmllbGQnO1xuaW1wb3J0IFJlY2FsY3VsYXRlZE9iamVjdHNHcm91cCBmcm9tICcuL1JlY2FsY3VsYXRlZE9iamVjdHNHcm91cCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWVsb29wIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucy5pbWFnZVNlbGVjdG9yKSB7XG4gICAgICB0aHJvdyBFcnJvcignaW1hZ2Ugc2VsZWN0b3IgaXMgbm90IGRlZmluZWQnKTtcbiAgICB9XG4gICAgbGV0IGNhbnZhcztcbiAgICB0aGlzLmdldE9wdGlvbnMgPSAoKSA9PiBvcHRpb25zO1xuXG4gICAgdGhpcy5nZXRDYW52YXMgPSAoKSA9PiBjYW52YXM7XG4gICAgdGhpcy5zZXRDYW52YXMgPSAoaW50ZXJuYWxDYW52YXMpID0+IHtcbiAgICAgIGNhbnZhcyA9IGludGVybmFsQ2FudmFzO1xuICAgIH07XG4gIH1cblxuICBzdGFydCgpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IG9wdGlvbnMgPSB0aGlzLmdldE9wdGlvbnMoKTtcbiAgICAgIGNvbnN0IGdhbWVGaWVsZCA9IG5ldyBHYW1lZmllbGQoe1xuICAgICAgICB3aWR0aDogMTQyMCxcbiAgICAgICAgaGVpZ2h0OiAyMDQ4LFxuICAgICAgICBjYW52YXNJZDogb3B0aW9ucy5jYW52YXNJZCxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgY2FudmFzID0gZ2FtZUZpZWxkLmdldENhbnZhcygpO1xuICAgICAgdGhpcy5zZXRDYW52YXMoY2FudmFzKTtcbiAgICAgIHRoaXMuZHJhd1BpZWNlcyhvcHRpb25zLnNjYWxlKTtcbiAgICAgIGNhbnZhcy5vbignb2JqZWN0OnNlbGVjdGVkJywgKCkgPT4ge1xuICAgICAgICBpZiAod2luZG93LmRlYnVnQXBwKSB7XG4gICAgICAgICAgY29uc3QgYWN0aXZlT2JqZWN0ID0gY2FudmFzLmdldEFjdGl2ZU9iamVjdCgpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGFjdGl2ZU9iamVjdCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgY2FudmFzLm9uKCdvYmplY3Q6bW9kaWZpZWQnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGFjdGl2ZU9iamVjdCA9IGNhbnZhcy5nZXRBY3RpdmVPYmplY3QoKTtcbiAgICAgICAgaWYgKGFjdGl2ZU9iamVjdCBpbnN0YW5jZW9mIGZhYnJpYy5QYXRoKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGFjdGl2ZU9iamVjdC50cmlnZ2VyKCdyZWNhbGN1bGF0ZScpO1xuICAgICAgICBjb25zdCBhY3RpdmVPYmplY3ROZWlnaGJvdXJzID0gdGhpcy5nZXROZWlnaGJvdXJzKGFjdGl2ZU9iamVjdCk7XG4gICAgICAgIGxldCBpc01lcmdlZCA9IGZhbHNlO1xuICAgICAgICBjYW52YXMuZm9yRWFjaE9iamVjdCgocG90ZW50aWFsKSA9PiB7XG4gICAgICAgICAgaWYgKGlzTWVyZ2VkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChwb3RlbnRpYWwgPT09IGFjdGl2ZU9iamVjdCB8fCAhYWN0aXZlT2JqZWN0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKEdhbWVsb29wLmlzTmVpZ2hib3VyKGFjdGl2ZU9iamVjdE5laWdoYm91cnMsIHBvdGVudGlhbCkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzQ2xvc2VzdChhY3RpdmVPYmplY3QsIHBvdGVudGlhbCkpIHtcbiAgICAgICAgICAgICAgaXNNZXJnZWQgPSB0cnVlO1xuICAgICAgICAgICAgICB0aGlzLmRyYXdHcm91cChhY3RpdmVPYmplY3QsIHBvdGVudGlhbCk7XG4gICAgICAgICAgICAgIGNhbnZhcy5yZW1vdmUoYWN0aXZlT2JqZWN0KTtcbiAgICAgICAgICAgICAgY2FudmFzLnJlbW92ZShwb3RlbnRpYWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGRyYXdTdmcoaW1nKSB7XG4gICAgY29uc3QgY2FudmFzID0gdGhpcy5nZXRDYW52YXMoKTtcbiAgICBjb25zdCBwYXRoID0gbmV3IGZhYnJpYy5QYXRoKFxuICAgICAgJ004NS40NDYsNTIuMjg0Yy0zLjkwMSwwLTUuMjIzLTIuMTctNS43NzMtMy4wNThjLTEuMTQ2LTEuODUtMy4yOTEtMy40NTUtNS40NjktNC4yNjhjLTEuMDQ5LTAuMjUxLTIuMTU5LDAuMzc3LTIuMTY1LDIuMzQyICB2MjQuNzM3aC0wLjAwMXYwLjAwMUg0Ni4yODdjLTEuOTc4LDAuMDAyLTIuNjA0LDEuMTIyLTIuMzQ3LDIuMTc3YzAuODE1LDIuMTczLDIuNDE4LDQuMzEyLDQuMjY0LDUuNDU3ICBjMC44ODksMC41NTEsMy4wNTgsMS44NzIsMy4wNTgsNS43NzJjMCw1LjI3Ny01LjkzNCw5LjU1NS0xMy4yNTMsOS41NTVjLTcuMzIsMC0xMy4yNTQtNC4yNzctMTMuMjU0LTkuNTU1ICBjMC0zLjkwMSwyLjE3LTUuMjIyLDMuMDU5LTUuNzcyYzEuODQ4LTEuMTQ3LDMuNDUzLTMuMjkxLDQuMjY4LTUuNDY5YzAuMjQ5LTEuMDQ5LTAuMzc5LTIuMTU5LTIuMzQyLTIuMTY1SDVWNDcuMzE0ICBjMC0xLjk3NywxLjExNC0yLjYwNiwyLjE2Ni0yLjM1NWMyLjE3OCwwLjgxMiw0LjMyMiwyLjQxOCw1LjQ3LDQuMjY4YzAuNTUxLDAuODg4LDEuODcxLDMuMDU4LDUuNzcyLDMuMDU4ICBjNS4yNzgsMCw5LjU1Ni01LjkzNCw5LjU1Ni0xMy4yNTRjMC03LjMxOS00LjI3Ny0xMy4yNTMtOS41NTYtMTMuMjUzYy0zLjkwMSwwLTUuMjIyLDIuMTctNS43NzIsMy4wNTkgIGMtMS4xNDYsMS44NDUtMy4yODQsMy40NDctNS40NTgsNC4yNjNDNi4xMjIsMzMuMzU2LDUsMzIuNzI3LDUsMzAuNzQ1VjVoNjcuMDM4djAuMDAxTDcyLjAzOSw1djI1Ljc1OSAgYzAuMDA2LDEuOTcsMS4xMjQsMi41OTcsMi4xNzcsMi4zNGMyLjE3My0wLjgxNSw0LjMxMi0yLjQxOCw1LjQ1Ny00LjI2M2MwLjU1MS0wLjg4OSwxLjg3Mi0zLjA1OSw1Ljc3My0zLjA1OSAgYzUuMjc2LDAsOS41NTQsNS45MzQsOS41NTQsMTMuMjUzQzk1LDQ2LjM1MSw5MC43MjMsNTIuMjg0LDg1LjQ0Niw1Mi4yODR6JyxcbiAgICAgIHtcbiAgICAgICAgZmlsbDogbmV3IGZhYnJpYy5QYXR0ZXJuKHtcbiAgICAgICAgICBzb3VyY2U6IGltZyxcbiAgICAgICAgfSksXG4gICAgICB9LFxuICAgICk7XG4gICAgcGF0aC5zZXQoeyB0b3A6IDE1MCwgbGVmdDogMTUwIH0pO1xuICAgIGNhbnZhcy5hZGQocGF0aCk7XG4gICAgY2FudmFzLnJlbmRlckFsbCgpO1xuICB9XG5cbiAgZHJhd1BpZWNlcyhzY2FsZSA9IDEpIHtcbiAgICBjb25zdCBvcHRpb25zID0gdGhpcy5nZXRPcHRpb25zKCk7XG4gICAgY29uc3QgY2FudmFzID0gdGhpcy5nZXRDYW52YXMoKTtcbiAgICBjb25zdCBpbWFnZSA9IG5ldyBJbWFnZShvcHRpb25zLmltYWdlU2VsZWN0b3IpO1xuXG4gICAgaW1hZ2Uuc3BsaXRJbWFnZVRvUGllY2VzKHsgY29sTGVuZ3RoOiBvcHRpb25zLmNvbHMsIHJvd0xlbmd0aDogb3B0aW9ucy5yb3dzIH0pO1xuICAgIGNvbnN0IHBpZWNlcyA9IGltYWdlLmdldEltYWdlUGllY2VzKCk7XG5cbiAgICBwaWVjZXMuZm9yRWFjaCgocGllY2UsIHBpZWNlUG9zaXRpb24pID0+IHtcbiAgICAgIGNvbnN0IGxhc3QgPSBwaWVjZVBvc2l0aW9uID09PSAocGllY2VzLmxlbmd0aCAtIDEpO1xuICAgICAgY29uc3QgZHJhd0NhbGxiYWNrID0gR2FtZWxvb3AuZHJhd0NhbGxiYWNrLmJpbmQobnVsbCwgeyBjYW52YXMsIGxhc3QsIHBpZWNlUG9zaXRpb24sIHNjYWxlIH0pO1xuICAgICAgLy8gY29uc3QgZHJhd1N2ZyA9IHRoaXMuZHJhd1N2Zy5iaW5kKHRoaXMpO1xuICAgICAgZmFicmljLkltYWdlLmZyb21VUkwocGllY2UuZ2V0Q29udGVudCgpLCBkcmF3Q2FsbGJhY2spO1xuICAgICAgLy8gZmFicmljLnV0aWwubG9hZEltYWdlKHBpZWNlLmdldENvbnRlbnQoKSwgZHJhd1N2Zyk7XG4gICAgfSk7XG4gIH1cblxuICBzdGF0aWMgZHJhd0NhbGxiYWNrKGFkZGl0aW9uYWxQYXJhbXMsIGltZykge1xuICAgIGNvbnN0IHsgY2FudmFzLCBsYXN0LCBwaWVjZVBvc2l0aW9uLCBzY2FsZSB9ID0gYWRkaXRpb25hbFBhcmFtcztcbiAgICBjb25zdCB0b3AgPSBmYWJyaWMudXRpbC5nZXRSYW5kb21JbnQoMCwgMzAwKTtcbiAgICBjb25zdCBsZWZ0ID0gZmFicmljLnV0aWwuZ2V0UmFuZG9tSW50KDAsIDMwMCk7XG5cbiAgICBpbWcuc2V0KCdoYXNDb250cm9scycsIGZhbHNlKTtcbiAgICBpbWcuc2V0KCdoYXNCb3JkZXJzJywgZmFsc2UpO1xuICAgIGltZy5zZXQoJ3RvcCcsIHRvcCk7XG4gICAgaW1nLnNldCgnbGVmdCcsIGxlZnQpO1xuICAgIGltZy5zZXQoJ3BpZWNlUG9zaXRpb24nLCBwaWVjZVBvc2l0aW9uKTtcbiAgICBpbWcuc2NhbGUoc2NhbGUpO1xuXG4gICAgY2FudmFzLmFkZChpbWcpO1xuICAgIGlmIChsYXN0KSB7XG4gICAgICBjYW52YXMucmVuZGVyQWxsKCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0TmVpZ2hib3VycyhleGFtT2JqZWN0KSB7XG4gICAgY29uc3QgbmVpZ2hib3VycyA9IFtdO1xuICAgIGlmIChleGFtT2JqZWN0KSB7XG4gICAgICBsZXQgcGllY2VQb3NpdGlvbnMgPSBbXTtcbiAgICAgIGlmICh0eXBlb2YgZXhhbU9iamVjdC5waWVjZVBvc2l0aW9uICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBwaWVjZVBvc2l0aW9ucy5wdXNoKGV4YW1PYmplY3QucGllY2VQb3NpdGlvbik7XG4gICAgICB9IGVsc2UgaWYgKGV4YW1PYmplY3QucGllY2VQb3NpdGlvbnMgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICBwaWVjZVBvc2l0aW9ucyA9IGV4YW1PYmplY3QucGllY2VQb3NpdGlvbnM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBFcnJvcignZXhhbU9iamVjdCBkb2VzbmB0IGNvbnRhaW4gYW55IGluZm8gYWJvdXQgcGllY2UgcG9zaXRpb24nKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG9wdGlvbnMgPSB0aGlzLmdldE9wdGlvbnMoKTtcbiAgICAgIHBpZWNlUG9zaXRpb25zLmZvckVhY2goKHBpZWNlUG9zaXRpb24pID0+IHtcbiAgICAgICAgY29uc3QgYWN0dWFsUm93ID0gTWF0aC5mbG9vcihwaWVjZVBvc2l0aW9uIC8gb3B0aW9ucy5jb2xzKTtcbiAgICAgICAgY29uc3QgYWN0dWFsQ29sID0gcGllY2VQb3NpdGlvbiAlIG9wdGlvbnMuY29scztcbiAgICAgICAgaWYgKGFjdHVhbFJvdyAhPT0gMCkge1xuICAgICAgICAgIG5laWdoYm91cnMucHVzaCgocGllY2VQb3NpdGlvbiAtIG9wdGlvbnMuY29scykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhY3R1YWxSb3cgPCAob3B0aW9ucy5yb3dzIC0gMSkpIHtcbiAgICAgICAgICBuZWlnaGJvdXJzLnB1c2goKHBpZWNlUG9zaXRpb24gKyBvcHRpb25zLmNvbHMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhY3R1YWxDb2wgIT09IDApIHtcbiAgICAgICAgICBuZWlnaGJvdXJzLnB1c2goKHBpZWNlUG9zaXRpb24gLSAxKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjdHVhbENvbCA8IChvcHRpb25zLmNvbHMgLSAxKSkge1xuICAgICAgICAgIG5laWdoYm91cnMucHVzaCgocGllY2VQb3NpdGlvbiArIDEpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBuZWlnaGJvdXJzO1xuICB9XG5cbiAgaXNDbG9zZXN0KGN1cnJlbnQsIHBvdGVudGlhbCkge1xuICAgIGNvbnN0IGFjdGl2ZU9iamVjdEl0ZW1zID0gY3VycmVudCBpbnN0YW5jZW9mIGZhYnJpYy5Hcm91cCA/IGN1cnJlbnQuZ2V0T2JqZWN0cygpIDogW2N1cnJlbnRdO1xuICAgIGNvbnN0IHBvdGVudGlhbEl0ZW1zID0gcG90ZW50aWFsIGluc3RhbmNlb2YgZmFicmljLkdyb3VwID8gcG90ZW50aWFsLmdldE9iamVjdHMoKSA6IFtwb3RlbnRpYWxdO1xuXG4gICAgZm9yIChjb25zdCBhY3RpdmVJdGVtIG9mIGFjdGl2ZU9iamVjdEl0ZW1zKSB7XG4gICAgICBmb3IgKGNvbnN0IHBvdGVudGlhbEl0ZW0gb2YgcG90ZW50aWFsSXRlbXMpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNQaWVjZXNDbG9zZShhY3RpdmVJdGVtLCBwb3RlbnRpYWxJdGVtKSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGlzUGllY2VzQ2xvc2UoZmlyc3RQaWVjZSwgc2Vjb25kUGllY2UpIHtcbiAgICBjb25zdCBvcHRpb25zID0gdGhpcy5nZXRPcHRpb25zKCk7XG4gICAgY29uc3QgY2xvc2VzdFNlbnNpdGl2aXR5ID0gb3B0aW9ucy5uZWlnaGJvdXJzU2Vuc2l0aXZpdHk7XG4gICAgbGV0IHhEaWZmZXJlbmNlID0gTWF0aC5hYnMoZmlyc3RQaWVjZS5hQ29vcmRzLnRyLnggLSBzZWNvbmRQaWVjZS5hQ29vcmRzLnRsLngpO1xuICAgIGxldCB5RGlmZmVyZW5jZSA9IE1hdGguYWJzKGZpcnN0UGllY2UuYUNvb3Jkcy50ci55IC0gc2Vjb25kUGllY2UuYUNvb3Jkcy50bC55KTtcbiAgICBpZiAoeERpZmZlcmVuY2UgPCBjbG9zZXN0U2Vuc2l0aXZpdHkgJiYgeURpZmZlcmVuY2UgPCBjbG9zZXN0U2Vuc2l0aXZpdHkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHhEaWZmZXJlbmNlID0gTWF0aC5hYnMoZmlyc3RQaWVjZS5hQ29vcmRzLnRsLnggLSBzZWNvbmRQaWVjZS5hQ29vcmRzLnRyLngpO1xuICAgIHlEaWZmZXJlbmNlID0gTWF0aC5hYnMoZmlyc3RQaWVjZS5hQ29vcmRzLnRsLnkgLSBzZWNvbmRQaWVjZS5hQ29vcmRzLnRyLnkpO1xuICAgIGlmICh4RGlmZmVyZW5jZSA8IGNsb3Nlc3RTZW5zaXRpdml0eSAmJiB5RGlmZmVyZW5jZSA8IGNsb3Nlc3RTZW5zaXRpdml0eSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgeERpZmZlcmVuY2UgPSBNYXRoLmFicyhmaXJzdFBpZWNlLmFDb29yZHMuYmwueCAtIHNlY29uZFBpZWNlLmFDb29yZHMudGwueCk7XG4gICAgeURpZmZlcmVuY2UgPSBNYXRoLmFicyhmaXJzdFBpZWNlLmFDb29yZHMuYmwueSAtIHNlY29uZFBpZWNlLmFDb29yZHMudGwueSk7XG4gICAgaWYgKHhEaWZmZXJlbmNlIDwgY2xvc2VzdFNlbnNpdGl2aXR5ICYmIHlEaWZmZXJlbmNlIDwgY2xvc2VzdFNlbnNpdGl2aXR5KSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICB4RGlmZmVyZW5jZSA9IE1hdGguYWJzKGZpcnN0UGllY2UuYUNvb3Jkcy50bC54IC0gc2Vjb25kUGllY2UuYUNvb3Jkcy5ibC54KTtcbiAgICB5RGlmZmVyZW5jZSA9IE1hdGguYWJzKGZpcnN0UGllY2UuYUNvb3Jkcy50bC55IC0gc2Vjb25kUGllY2UuYUNvb3Jkcy5ibC55KTtcbiAgICByZXR1cm4geERpZmZlcmVuY2UgPCBjbG9zZXN0U2Vuc2l0aXZpdHkgJiYgeURpZmZlcmVuY2UgPCBjbG9zZXN0U2Vuc2l0aXZpdHk7XG4gIH1cblxuICBzdGF0aWMgaXNOZWlnaGJvdXIoYWN0aXZlT2JqZWN0TmVpZ2hib3VycywgcG90ZW50aWFsKSB7XG4gICAgaWYgKHBvdGVudGlhbCBpbnN0YW5jZW9mIGZhYnJpYy5Hcm91cCkge1xuICAgICAgZm9yIChjb25zdCBwb3RlbnRpYWxJdGVtIG9mIHBvdGVudGlhbC5nZXRPYmplY3RzKCkpIHtcbiAgICAgICAgaWYgKGFjdGl2ZU9iamVjdE5laWdoYm91cnMuaW5kZXhPZihwb3RlbnRpYWxJdGVtLnBpZWNlUG9zaXRpb24pICE9PSAtMSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgcG90ZW50aWFsLnBpZWNlUG9zaXRpb24gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICByZXR1cm4gYWN0aXZlT2JqZWN0TmVpZ2hib3Vycy5pbmRleE9mKHBvdGVudGlhbC5waWVjZVBvc2l0aW9uKSAhPT0gLTE7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGRyYXdHcm91cChhY3RpdmVPYmplY3QsIHBvdGVudGlhbCkge1xuICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuZ2V0Q2FudmFzKCk7XG4gICAgY29uc3QgZ3JvdXBJdGVtcyA9IFtdO1xuICAgIGNvbnN0IHBpZWNlUG9zaXRpb25zID0gW107XG4gICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMuZ2V0T3B0aW9ucygpO1xuICAgIGNvbnN0IGJhc2VFbGVtZW50cyA9IHBvdGVudGlhbCBpbnN0YW5jZW9mIGZhYnJpYy5Hcm91cCA/IHBvdGVudGlhbC5nZXRPYmplY3RzKCkgOiBbcG90ZW50aWFsXTtcbiAgICBjb25zdCBhY3RpdmVPYmplY3RzID0gYWN0aXZlT2JqZWN0IGluc3RhbmNlb2YgZmFicmljLkdyb3VwID8gYWN0aXZlT2JqZWN0LmdldE9iamVjdHMoKSA6IFthY3RpdmVPYmplY3RdO1xuXG4gICAgLy8gYmFzZUVsZW1lbnQgaXMgdGhlIHBvdGVudGlhbCBlbGVtZW50IGl0c2VsZiBvciBmaXJzdCBlbGVtZW50IGZyb20gZ3JvdXA7XG4gICAgY29uc3QgYmFzZUVsZW1lbnQgPSBiYXNlRWxlbWVudHNbMF07XG4gICAgY29uc3QgeyBjb2wsIHJvdyB9ID0gR2FtZWxvb3AuZXh0cmFjdENvb3JkaW5hdGVzKGJhc2VFbGVtZW50LCBvcHRpb25zLmNvbHMpO1xuICAgIGNvbnN0IHplcm9EaXNwbGFjZW1lbnRYID0gY29sICogYmFzZUVsZW1lbnQuZ2V0V2lkdGgoKTtcbiAgICBjb25zdCB6ZXJvRGlzcGxhY2VtZW50WSA9IHJvdyAqIGJhc2VFbGVtZW50LmdldEhlaWdodCgpO1xuICAgIGNvbnN0IHhEaXNwbGFjZW1lbnQgPSBiYXNlRWxlbWVudC5sZWZ0IC0gemVyb0Rpc3BsYWNlbWVudFg7XG4gICAgY29uc3QgeURpc3BsYWNlbWVudCA9IGJhc2VFbGVtZW50LnRvcCAtIHplcm9EaXNwbGFjZW1lbnRZO1xuXG4gICAgY29uc3QgaXRlbURlY29tcG9zZSA9IChhY3RpdmVQaWVjZSkgPT4ge1xuICAgICAgdGhpcy5yZWNhbGN1bGF0ZVBpZWNlUG9zaXRpb25zKHtcbiAgICAgICAgb2JqOiBhY3RpdmVQaWVjZSxcbiAgICAgICAgeERpc3BsYWNlbWVudCxcbiAgICAgICAgeURpc3BsYWNlbWVudCxcbiAgICAgIH0pO1xuICAgICAgcGllY2VQb3NpdGlvbnMucHVzaChhY3RpdmVQaWVjZS5waWVjZVBvc2l0aW9uKTtcbiAgICAgIGdyb3VwSXRlbXMucHVzaChhY3RpdmVQaWVjZSk7XG4gICAgfTtcblxuICAgIGFjdGl2ZU9iamVjdHMuZm9yRWFjaChpdGVtRGVjb21wb3NlKTtcbiAgICBiYXNlRWxlbWVudHMuZm9yRWFjaChpdGVtRGVjb21wb3NlKTtcblxuICAgIGNvbnN0IGl0ZW1zUmVjYWxjdWxhYmxlR3JvdXAgPSBuZXcgUmVjYWxjdWxhdGVkT2JqZWN0c0dyb3VwKGdyb3VwSXRlbXMsIHtcbiAgICAgIGhhc0NvbnRyb2xzOiBmYWxzZSxcbiAgICAgIGhhc0JvcmRlcnM6IGZhbHNlLFxuICAgIH0pO1xuICAgIGl0ZW1zUmVjYWxjdWxhYmxlR3JvdXAuc2V0KCdwaWVjZVBvc2l0aW9ucycsIHBpZWNlUG9zaXRpb25zKTtcbiAgICBjYW52YXMuYWRkKGl0ZW1zUmVjYWxjdWxhYmxlR3JvdXApO1xuICAgIGNhbnZhcy5yZW5kZXJBbGwoKTtcblxuICAgIC8vIHJlY2FsY3VsYXRlZCBncm91cCBvYmplY3RzIGNvb3JkaW5hdGVzXG4gICAgLy8gaXQgcHJldmVudHMgdG8gZGlzYXBwZWFyaW5nIGdyb3VwIG9iamVjdCBhZnRlciBtZXJnZVxuICAgIGl0ZW1zUmVjYWxjdWxhYmxlR3JvdXAudHJpZ2dlcignc2VsZWN0ZWQnKTtcbiAgICBpdGVtc1JlY2FsY3VsYWJsZUdyb3VwLnRyaWdnZXIoJ3JlY2FsY3VsYXRlJyk7XG4gIH1cblxuICByZWNhbGN1bGF0ZVBpZWNlUG9zaXRpb25zKHsgb2JqLCB4RGlzcGxhY2VtZW50LCB5RGlzcGxhY2VtZW50IH0pIHtcbiAgICBjb25zdCBvcHRpb25zID0gdGhpcy5nZXRPcHRpb25zKCk7XG4gICAgY29uc3QgeyBjb2wsIHJvdyB9ID0gR2FtZWxvb3AuZXh0cmFjdENvb3JkaW5hdGVzKG9iaiwgb3B0aW9ucy5jb2xzKTtcbiAgICBjb25zdCB6ZXJvRGlzcGxhY2VtZW50VG9wID0gcm93ICogb2JqLmdldEhlaWdodCgpO1xuICAgIGNvbnN0IHplcm9EaXNwbGFjZW1lbnRMZWZ0ID0gY29sICogb2JqLmdldFdpZHRoKCk7XG4gICAgY29uc3QgcmVjYWxjdWxhdGVkVG9wID0gemVyb0Rpc3BsYWNlbWVudFRvcCArIHlEaXNwbGFjZW1lbnQ7XG4gICAgY29uc3QgcmVjYWxjdWxhdGVkTGVmdCA9IHplcm9EaXNwbGFjZW1lbnRMZWZ0ICsgeERpc3BsYWNlbWVudDtcbiAgICBvYmouc2V0VG9wKHJlY2FsY3VsYXRlZFRvcCk7XG4gICAgb2JqLnNldExlZnQocmVjYWxjdWxhdGVkTGVmdCk7XG4gICAgb2JqLnNldENvb3JkcygpO1xuICB9XG5cbiAgc3RhdGljIGV4dHJhY3RDb29yZGluYXRlcyhvYmosIGNvbHMpIHtcbiAgICBjb25zdCBjb2wgPSBvYmoucGllY2VQb3NpdGlvbiAlIGNvbHM7XG4gICAgY29uc3Qgcm93ID0gTWF0aC5mbG9vcihvYmoucGllY2VQb3NpdGlvbiAvIGNvbHMpO1xuICAgIHJldHVybiB7IGNvbCwgcm93IH07XG4gIH1cbn1cbiIsIi8qKlxuICogQ3JlYXRlZCBieSBkaW1hIG9uIDA5LzA2LzIwMTcuXG4gKi9cbmltcG9ydCBQaWVjZSBmcm9tICcuL1BpZWNlJztcbmltcG9ydCBDb21wb3NpdGlvbiBmcm9tICcuL0NvbXBvc2l0aW9uJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW1hZ2Uge1xuICBjb25zdHJ1Y3RvcihzZWxlY3Rvcikge1xuICAgIGNvbnN0IGltYWdlU2VsZWN0b3IgPSBgaW1nJHtzZWxlY3Rvcn1gO1xuICAgIHRoaXMuaW1hZ2VFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihpbWFnZVNlbGVjdG9yKTtcbiAgICBpZiAoIXRoaXMuaW1hZ2VFbGVtZW50KSB7XG4gICAgICB0aHJvdyBFcnJvcihgVGhlcmUgaXMgbm8gaW1nIGVsZW1lbnQgd2l0aCBwcm92aWRlZCBzZWxlY3RvciAke2ltYWdlU2VsZWN0b3J9YCk7XG4gICAgfVxuXG4gICAgdGhpcy5pbWFnZUluc3RhbmNlID0gdGhpcy5nZXRGYWJyaWNJbWFnZUluc3RhbmNlKCk7XG4gICAgdGhpcy5pbWFnZVBpZWNlcyA9IG5ldyBDb21wb3NpdGlvbigpO1xuICB9XG5cbiAgZ2V0RmFicmljSW1hZ2VJbnN0YW5jZSgpIHtcbiAgICByZXR1cm4gdGhpcy5pbWFnZUluc3RhbmNlIHx8IG5ldyBmYWJyaWMuSW1hZ2UodGhpcy5pbWFnZUVsZW1lbnQpO1xuICB9XG5cbiAgc3BsaXRJbWFnZVRvUGllY2VzKHsgY29sTGVuZ3RoID0gNiwgcm93TGVuZ3RoID0gNiB9ID0ge30pIHtcbiAgICBjb25zdCBjb2xTaXplID0gdGhpcy5pbWFnZUluc3RhbmNlLmdldFdpZHRoKCkgLyBjb2xMZW5ndGg7XG4gICAgY29uc3Qgcm93U2l6ZSA9IHRoaXMuaW1hZ2VJbnN0YW5jZS5nZXRIZWlnaHQoKSAvIHJvd0xlbmd0aDtcbiAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCByb3dMZW5ndGg7IHJvdyArPSAxKSB7XG4gICAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCBjb2xMZW5ndGg7IGNvbCArPSAxKSB7XG4gICAgICAgIGNvbnN0IGRhdGFVcmwgPSB0aGlzLmltYWdlSW5zdGFuY2UudG9EYXRhVVJMKHtcbiAgICAgICAgICBsZWZ0OiBjb2xTaXplICogY29sLFxuICAgICAgICAgIHRvcDogcm93U2l6ZSAqIHJvdyxcbiAgICAgICAgICB3aWR0aDogY29sU2l6ZSxcbiAgICAgICAgICBoZWlnaHQ6IHJvd1NpemUsXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBwaWVjZU9wdGlvbnMgPSB7XG4gICAgICAgICAgY29udGVudDogZGF0YVVybCxcbiAgICAgICAgICBwb3NpdGlvbjogcm93ICogY29sLFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBwaWVjZSA9IG5ldyBQaWVjZShwaWVjZU9wdGlvbnMpO1xuICAgICAgICB0aGlzLmltYWdlUGllY2VzLmFkZFBpZWNlKHBpZWNlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnZXRJbWFnZVBpZWNlcygpIHtcbiAgICByZXR1cm4gdGhpcy5pbWFnZVBpZWNlcy5nZXRQaWVjZXMoKTtcbiAgfVxuXG4gIGdldEltYWdlRWxlbWVudCgpIHtcbiAgICByZXR1cm4gdGhpcy5pbWFnZUVsZW1lbnQ7XG4gIH1cbn1cbiIsIi8qKlxuICogQ3JlYXRlZCBieSBkaW1hIG9uIDAyLzA3LzIwMTcuXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBpZWNlIHtcbiAgY29uc3RydWN0b3IoeyBjb250ZW50LCBwb3NpdGlvbiB9ID0ge30pIHtcbiAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiBwb3NpdGlvbiA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHRocm93IEVycm9yKCdwaWVjZSByZXF1aXJlZCBjb250ZW50IGFuZCBwb3NpdGlvbicpO1xuICAgIH1cbiAgICB0aGlzLmdldENvbnRlbnQgPSAoKSA9PiBjb250ZW50O1xuICAgIHRoaXMuZ2V0UG9zaXRpb24gPSAoKSA9PiBwb3NpdGlvbjtcbiAgICByZXR1cm4gdGhpcy5nZXRDb250ZW50KCk7XG4gIH1cblxuICBnZXRSb3coY29scykge1xuICAgIHJldHVybiBNYXRoLmZsb29yKHRoaXMuZ2V0UG9zaXRpb24oKSAvIGNvbHMpO1xuICB9XG5cbiAgZ2V0Q29sKGNvbHMpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRQb3NpdGlvbigpICUgY29scztcbiAgfVxufVxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGRpbWEgb24gMDcvMDcvMjAxNy5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVjYWxjdWxhdGVkT2JqZWN0c0dyb3VwIHtcbiAgY29uc3RydWN0b3IoZ3JvdXBJdGVtcywgb3B0aW9ucyA9IHt9KSB7XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGdyb3VwSXRlbXMpKSB7XG4gICAgICB0aHJvdyBFcnJvcignR3JvdXAgSXRlbXMgbXVzdCBiZSBhbiBhcnJheScpO1xuICAgIH1cbiAgICBjb25zdCBncm91cCA9IG5ldyBmYWJyaWMuR3JvdXAoZ3JvdXBJdGVtcywgb3B0aW9ucyk7XG4gICAgZ3JvdXAub24oJ3NlbGVjdGVkJywgdGhpcy5vblNlbGVjdGVkKTtcbiAgICBncm91cC5vbigncmVjYWxjdWxhdGUnLCB0aGlzLm9uTW9kaWZpZWQpO1xuXG4gICAgZ3JvdXAucmVjYWxjdWxhdGVBQ29vcmRzID0gdGhpcy5yZWNhbGN1bGF0ZUFDb29yZHM7XG4gICAgZ3JvdXAub25Nb2RpZmllZCA9IHRoaXMub25Nb2RpZmllZDtcbiAgICByZXR1cm4gZ3JvdXA7XG4gIH1cblxuICBvblNlbGVjdGVkKCkge1xuICAgIHRoaXMuc2VsZWN0ZWRUb3AgPSB0aGlzLnRvcDtcbiAgICB0aGlzLnNlbGVjdGVkTGVmdCA9IHRoaXMubGVmdDtcbiAgfVxuXG4gIG9uTW9kaWZpZWQoKSB7XG4gICAgY29uc3QgZ3JvdXBPYmplY3RzID0gdGhpcy5nZXRPYmplY3RzKCk7XG4gICAgZ3JvdXBPYmplY3RzLmZvckVhY2goKGdyb3VwSXRlbSkgPT4ge1xuICAgICAgdGhpcy5yZWNhbGN1bGF0ZUFDb29yZHMoZ3JvdXBJdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlY2FsY3VsYXRlQUNvb3JkcyhpdGVtKSB7XG4gICAgY29uc3QgY29vcmRzID0ge307XG4gICAgY29uc3QgaXRlbUNvb3JkcyA9IGl0ZW0uYUNvb3JkcztcbiAgICBjb25zdCB4ID0gdGhpcy5sZWZ0IC0gdGhpcy5zZWxlY3RlZExlZnQ7XG4gICAgY29uc3QgeSA9IHRoaXMudG9wIC0gdGhpcy5zZWxlY3RlZFRvcDtcbiAgICBjb25zdCBvZmZzZXQgPSB7IHgsIHkgfTtcblxuICAgIGNvb3Jkcy50ciA9IG5ldyBmYWJyaWMuUG9pbnQoaXRlbUNvb3Jkcy50ci54ICsgb2Zmc2V0LngsIGl0ZW1Db29yZHMudHIueSArIG9mZnNldC55KTtcbiAgICBjb29yZHMudGwgPSBuZXcgZmFicmljLlBvaW50KGl0ZW1Db29yZHMudGwueCArIG9mZnNldC54LCBpdGVtQ29vcmRzLnRsLnkgKyBvZmZzZXQueSk7XG4gICAgY29vcmRzLmJyID0gbmV3IGZhYnJpYy5Qb2ludChpdGVtQ29vcmRzLmJyLnggKyBvZmZzZXQueCwgaXRlbUNvb3Jkcy5ici55ICsgb2Zmc2V0LnkpO1xuICAgIGNvb3Jkcy5ibCA9IG5ldyBmYWJyaWMuUG9pbnQoaXRlbUNvb3Jkcy5ibC54ICsgb2Zmc2V0LngsIGl0ZW1Db29yZHMuYmwueSArIG9mZnNldC55KTtcbiAgICBpdGVtLmFDb29yZHMgPSBjb29yZHM7XG4gICAgaXRlbS50b3AgPSBjb29yZHMudGwueTtcbiAgICBpdGVtLmxlZnQgPSBjb29yZHMudGwueDtcbiAgfVxufVxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGRpbWEgb24gMTgvMDUvMjAxNy5cbiAqL1xuaW1wb3J0IEdhbWVsb29wIGZyb20gJy4vY2xhc3Nlcy9HYW1lbG9vcCc7XG5cbmNvbnN0IG9wdGlvbnMgPSB7XG4gIGNhbnZhc0lkOiAnYycsXG4gIHJvd3M6IDYsXG4gIGNvbHM6IDYsXG4gIHNjYWxlOiAwLjgsXG4gIGltYWdlU2VsZWN0b3I6ICdbampwLWltYWdlXScsXG4gIG5laWdoYm91cnNTZW5zaXRpdml0eTogMjAsXG59O1xuY29uc3QgZ2FtZUxvb3AgPSBuZXcgR2FtZWxvb3Aob3B0aW9ucyk7XG5cbmdhbWVMb29wLnN0YXJ0KCk7XG4iXX0="}