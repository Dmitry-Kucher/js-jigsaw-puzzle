{"version":3,"sources":["classes/Image.js"],"names":["Image","selector","imageSelector","imageElement","document","querySelector","Error","imageInstance","getFabricImageInstance","imagePieces","fabric","colLength","rowLength","numberOfCols","numberOfRows","colSize","getWidth","rowSize","getHeight","rows","cols","dataUrl","toDataURL","left","top","width","height","piece","setSteps","addPiece","getPieces"],"mappings":";;;;;;qjBAAA;;;;;AAGA;;;;AACA;;;;;;;;IAEqBA,K;AACnB,iBAAYC,QAAZ,EAAsB;AAAA;;AACpB,QAAMC,wBAAsBD,QAA5B;AACA,SAAKE,YAAL,GAAoBC,SAASC,aAAT,CAAuBH,aAAvB,CAApB;AACA,QAAI,CAAC,KAAKC,YAAV,EAAwB;AACtB,YAAM,IAAIG,KAAJ,qDAA4DJ,aAA5D,CAAN;AACD;;AAED,SAAKK,aAAL,GAAqB,KAAKC,sBAAL,EAArB;AACA,SAAKC,WAAL,GAAmB,sBAAnB;AACD;;;;6CAEwB;AACvB,aAAO,KAAKF,aAAL,IAAsB,IAAIG,OAAOV,KAAX,CAAiB,KAAKG,YAAtB,CAA7B;AACD;;;yCAEyD;AAAA,qFAAJ,EAAI;AAAA,gCAArCQ,SAAqC;AAAA,UAArCA,SAAqC,kCAAzB,CAAyB;AAAA,gCAAtBC,SAAsB;AAAA,UAAtBA,SAAsB,kCAAV,CAAU;;AACxD,UAAMC,eAAeF,SAArB;AACA,UAAMG,eAAeF,SAArB;AACA,UAAMG,UAAU,KAAKR,aAAL,CAAmBS,QAAnB,KAAgCH,YAAhD;AACA,UAAMI,UAAU,KAAKV,aAAL,CAAmBW,SAAnB,KAAiCJ,YAAjD;AACA,WAAK,IAAIK,OAAO,CAAhB,EAAmBA,OAAOL,YAA1B,EAAwCK,QAAQ,CAAhD,EAAmD;AACjD,aAAK,IAAIC,OAAO,CAAhB,EAAmBA,OAAOP,YAA1B,EAAwCO,QAAQ,CAAhD,EAAmD;AACjD,cAAMC,UAAU,KAAKd,aAAL,CAAmBe,SAAnB,CAA6B;AAC3CC,kBAAMR,UAAUK,IAD2B;AAE3CI,iBAAKP,UAAUE,IAF4B;AAG3CM,mBAAOV,OAHoC;AAI3CW,oBAAQT;AAJmC,WAA7B,CAAhB;AAMA,cAAMU,QAAQ,oBAAUN,OAAV,CAAd;AACAM,gBAAMC,QAAN,CAAe,EAAEjB,oBAAF,EAAaC,oBAAb,EAAf;AACA,eAAKH,WAAL,CAAiBoB,QAAjB,CAA0BF,KAA1B;AACD;AACF;AACF;;;qCAEgB;AACf,aAAO,KAAKlB,WAAL,CAAiBqB,SAAjB,EAAP;AACD;;;sCAEiB;AAChB,aAAO,KAAK3B,YAAZ;AACD;;;;;;kBA1CkBH,K","file":"Image.js","sourcesContent":["/**\n * Created by dima on 09/06/2017.\n */\nimport Piece from './Piece';\nimport Pieces from './Pieces';\n\nexport default class Image {\n  constructor(selector) {\n    const imageSelector = `img${selector}`;\n    this.imageElement = document.querySelector(imageSelector);\n    if (!this.imageElement) {\n      throw new Error(`There is no img element with provided selector ${imageSelector}`);\n    }\n\n    this.imageInstance = this.getFabricImageInstance();\n    this.imagePieces = new Pieces();\n  }\n\n  getFabricImageInstance() {\n    return this.imageInstance || new fabric.Image(this.imageElement);\n  }\n\n  splitImageToPieces({ colLength = 6, rowLength = 6 } = {}) {\n    const numberOfCols = colLength;\n    const numberOfRows = rowLength;\n    const colSize = this.imageInstance.getWidth() / numberOfCols;\n    const rowSize = this.imageInstance.getHeight() / numberOfRows;\n    for (let rows = 0; rows < numberOfRows; rows += 1) {\n      for (let cols = 0; cols < numberOfCols; cols += 1) {\n        const dataUrl = this.imageInstance.toDataURL({\n          left: colSize * cols,\n          top: rowSize * rows,\n          width: colSize,\n          height: rowSize,\n        });\n        const piece = new Piece(dataUrl);\n        piece.setSteps({ colLength, rowLength });\n        this.imagePieces.addPiece(piece);\n      }\n    }\n  }\n\n  getImagePieces() {\n    return this.imagePieces.getPieces();\n  }\n\n  getImageElement() {\n    return this.imageElement;\n  }\n}\n"]}